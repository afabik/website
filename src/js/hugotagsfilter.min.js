class HugoTagsFilter{constructor(t){this.FILTERS=t&&t.filters?t.filters:[{name:"tag",prefix:"tft-",buttonClass:"tft-button",allSelector:"#tfSelectAllTags",attrName:"data-tags"},{name:"section",prefix:"tfs-",buttonClass:"tfs-button",allSelector:"#tfSelectAllSections",attrName:"data-section"}],this.showItemClass=t&&t.showItemClass?t.showItemClass:"tf-show",this.activeButtonClass=t&&t.activeButtonClass?t.activeButtonClass:"active",this.filterItemClass=t&&t.filterItemClass?t.filterItemClass:"tf-filter-item",this.counterSelector=t&&t.counterSelector?t.counterSelector:"selectedItemCount",this.populateCount=!(!t||!t.populateCount)&&t.populateCount,this.setDisabledButtonClass=!(!t||!t.setDisabledButtonClass)&&t.setDisabledButtonClass,this.filterItems=document.getElementsByClassName(this.filterItemClass),this.selectedItemCount=0,this.filterValues={};for(var e=0;e<this.FILTERS.length;e++){this.FILTERS[e].buttonTotal=document.getElementsByClassName(this.FILTERS[e].buttonClass).length,this.FILTERS[e].selected=[],this.FILTERS[e].values=[];var s=document.getElementsByClassName(this.FILTERS[e].buttonClass);this.filterValues[this.FILTERS[e].name]=[];for(var i=0;i<s.length;i++){var l=s[i].id.replace(this.FILTERS[e].prefix,"");this.filterValues[this.FILTERS[e].name][l]={count:0,selected:0}}}this.showCheck(this.FILTERS[0].name,!0)}initFilterCount(t,e){if(e)for(var s in t)for(var i=0;i<this.filterItems.length;i++)for(var l=this.getAttrs(s,this.filterItems[i]),n=0;n<l.length;n++)t[s][l[n]].count++,t[s][l[n]].selected++;else{var a=document.getElementsByClassName(this.showItemClass);for(var s in t)for(var h in t[s])t[s][h].selected=0;for(n=0;n<a.length;n++)for(s in t){l=this.getAttrs(s,a[n]);for(var o=0;o<l.length;o++)t[s][l[o]].selected++}}return t}populateCounters(t){if(this.populateCount)for(var e=0;e<this.FILTERS.length;e++){var s=this.FILTERS[e].name,i=this.FILTERS[e].countPrefix,l=this.FILTERS[e].selectedPrefix;if(i||l)for(var n in t[s]){if(i)document.getElementById(`${i}${n}`).textContent=t[s][n].count;if(l){var a=document.getElementById(`${l}${n}`);a.textContent=t[s][n].selected,this.setDisabledButtonClass&&(0==a.textContent?this.addClassIfMissing(document.getElementById(this.FILTERS[e].prefix+n),this.setDisabledButtonClass):this.delClassIfPresent(document.getElementById(this.FILTERS[e].prefix+n),this.setDisabledButtonClass))}}}}getAttrs(t,e){return e.getAttribute("data-"+t).split(" ").filter(function(t){return t.length>0})}showAll(t){for(var e=0;e<this.FILTERS.length;e++)t?this.FILTERS[e].name===t&&(this.FILTERS[e].selected=[]):this.FILTERS[e].selected=[];this.showCheck(t)}checkFilter(t,e){for(var s=document.querySelector(`#${e}${t}`),i=0;i<this.FILTERS.length;i++)this.FILTERS[i].prefix===e&&(this.FILTERS[i].selected.indexOf(t)>=0?(this.FILTERS[i].selected.splice(t,1),this.delClassIfPresent(s,this.activeButtonClass)):(this.FILTERS[i].selected.push(t),this.addClassIfMissing(s,this.activeButtonClass)),this.delClassIfPresent(document.querySelector(this.FILTERS[i].allSelector),this.activeButtonClass),this.showCheck(this.FILTERS[i].name))}showCheck(t,e){for(var s=0;s<this.FILTERS.length;s++)if(this.FILTERS[s].name===t&&(0===this.FILTERS[s].selected.length||this.FILTERS[s].selected.length===this.FILTERS[s].buttonTotal)){for(var i=document.getElementsByClassName(this.FILTERS[s].buttonClass),l=0;l<i.length;l++)this.delClassIfPresent(i[l],this.activeButtonClass);this.addClassIfMissing(document.querySelector(this.FILTERS[s].allSelector),this.activeButtonClass)}this.selectedItemCount=0;for(s=0;s<this.filterItems.length;s++){this.delClassIfPresent(this.filterItems[s],this.showItemClass);var n=0;for(l=0;l<this.FILTERS.length;l++)this.checkVisibility(this.FILTERS[l].selected,this.filterItems[s].getAttribute(this.FILTERS[l].attrName))&&n++;n===this.FILTERS.length&&(this.filterItems[s].classList.contains(this.showItemClass)||(this.selectedItemCount++,this.addClassIfMissing(this.filterItems[s],this.showItemClass)))}document.getElementById(this.counterSelector)&&(document.getElementById(this.counterSelector).textContent=`${this.selectedItemCount}`),this.checkButtonCounts(e)}checkButtonCounts(t){this.filterValues=this.initFilterCount(this.filterValues,t),this.populateCounters(this.filterValues)}checkVisibility(t,e){if(t.length>0){for(var s=0;s<t.length;s++){if(e.split(" ").filter(function(t){return t.length>0}).indexOf(t[s])>=0)return!0}return!1}return!0}addClassIfMissing(t,e){t.classList.contains(e)||t.classList.add(e)}delClassIfPresent(t,e){t.classList.contains(e)&&t.classList.remove(e)}}window.HugoTagsFilter=HugoTagsFilter;
